{"version":3,"sources":["opencode/ui/core.cljs"],"mappings":"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","names":["opencode.ui.core/connect-ws!","ws","js/WebSocket","cljs.core._EQ_","js/location.protocol","js/location.host","cljs.core.swap_BANG_","opencode.ui.state/!state","cljs.core/assoc","m","e","js/JSON.parse","cljs.core.js__GT_clj","opencode.ui.state/push-event!","opencode.ui.github/fetch-issues!","opencode.ui.github/fetch-prs!","p__6219","map__6220","cljs.core/--destructure-map","cljs.core.get","opencode.ui.core/issue-item","number","title","state","opencode.ui.github/create-worktree!","opencode.ui.github/open-pr!","p__6221","map__6222","opencode.ui.core/pr-item","opencode.ui.core/events-log","evts","cljs.core/reverse","cljs.core/deref","iter__5480__auto__","s__6224","cljs.core/LazySeq","temp__5804__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5478__auto__","size__5479__auto__","cljs.core/count","b__6226","cljs.core/chunk-buffer","i__6225","vec__6227","cljs.core/-nth","cljs.core.nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__6223","cljs.core/chunk-rest","vec__6230","cljs.core/first","cljs.core/cons","cljs.core/rest","i","cljs.core.map_indexed","cljs.core/vector","cljs.core.pr_str","opencode.ui.core/app","map__6233","issues","prs","connected?","repo","s__6235","b__6237","i__6236","iter__6234","s__6239","b__6241","i__6240","iter__6238","p","opencode.ui.core/init","reagent.core.render","js/document","cljs.core/chunk-first"],"sourcesContent":["(ns opencode.ui.core\n  (:require [reagent.core :as r]\n            [opencode.ui.state :as S]\n            [opencode.ui.github :as gh]))\n\n(defn connect-ws! []\n  (let [ws (js/WebSocket. (str (if (= \"https:\" js/location.protocol) \"wss://\" \"ws://\")\n                               js/location.host \"/events\"))]\n    (set! (.-onopen ws) #(swap! S/!state assoc :connected? true))\n    (set! (.-onclose ws) #(swap! S/!state assoc :connected? false))\n    (set! (.-onmessage ws)\n          (fn [m]\n            (let [e (js/JSON.parse (.-data m))\n                  e (js->clj e :keywordize-keys true)]\n              (S/push-event! e)\n              (when (= (:type e) \":refresh/gh\")\n                (gh/fetch-issues!)\n                (gh/fetch-prs!))))))\n  nil)\n\n(defn issue-item [{:keys [number title state]}]\n  [:div.border.p-2.rounded.mb-2\n   [:div.text-sm (str \"#\" number \" \u2022 \" state)]\n   [:div.font-bold title]\n   [:div.mt-2.flex.gap-2\n    [:button {:on-click #(gh/create-worktree! number)} \"Create worktree\"]\n    [:button {:on-click #(gh/open-pr! number)} \"Open PR\"]]])\n\n(defn pr-item [{:keys [number title state]}]\n  [:div.border.p-2.rounded.mb-2\n   [:div.text-sm (str \"PR #\" number \" \u2022 \" state)]\n   [:div.font-bold title]])\n\n(defn events-log []\n  (let [evts (reverse (:events @S/!state))]\n    [:div.mt-4\n     [:h3 \"Events\"]\n     [:div {:style {:max-height \"300px\" :overflow \"auto\"}}\n      (for [[i e] (map-indexed vector evts)]\n        ^{:key i}\n        [:pre.text-xs (pr-str e)])]]))\n\n(defn app []\n  (let [{:keys [issues prs connected? repo]} @S/!state]\n    [:div.p-4\n     [:h2 \"Opencode Reactant\"]\n     [:div.text-sm (str \"Repo: \" repo \" \u2022 WS \" (if connected? \"connected\" \"disconnected\"))]\n     [:div.grid.grid-cols-2.gap-4.mt-4\n      [:div\n       [:h3 \"Issues\"]\n       (if (seq issues)\n         (for [i issues] ^{:key (:id i)} [issue-item i])\n         [:div.text-sm.opacity-70 \"No issues loaded.\"])]\n      [:div\n       [:h3 \"Pull Requests\"]\n       (if (seq prs)\n         (for [p prs] ^{:key (:id p)} [pr-item p])\n         [:div.text-sm.opacity-70 \"No PRs loaded.\"])]]\n     [events-log]]))\n\n(defn init []\n  (connect-ws!)\n  (gh/fetch-issues!)\n  (gh/fetch-prs!)\n  (r/render [app] (.getElementById js/document \"app\")))"]}